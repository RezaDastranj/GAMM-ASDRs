[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Generalized Additive Forecasting Mortality",
    "section": "",
    "text": "This study introduces a novel Generalized Additive Mixed Model (GAMM) for mortality modelling, employing mortality covariates \\(k_{t}\\) and \\(k_{ct}\\) as proposed by Dastranj-Kolář (DK-LME). The GAMM effectively predicts age-specific death rates (ASDRs) in both single and multi-population contexts. Empirical evaluations using data from the Human Mortality Database (HMD) demonstrate the model’s exceptional performance in accurately capturing observed mortality rates. In the DK-LME model, the relationship between log ASDRs, and \\(k_{t}\\) did not provide a perfect fit. Our study shows that the GAMM addresses this limitation. Additionally, as discussed in the DK-LME model, ASDRs represent longitudinal data. The GAMM offers a suitable alternative to the DK-LME model for modelling and forecasting mortality rates. We will compare the forecast accuracy of the GAMM with both the DK-LME and Li-Lee models in multi-population scenarios, as well as with the Lee-Carter models in single population scenarios. Comparative analyses highlight the GAMM’s superior sample fitting and out-of-sample forecasting performance, positioning it as a promising tool for mortality modelling and forecasting.\nKeywords: Longitudinal data analysis, Nonparametric modelling, Smoothing functions, Restricted maximum likelihood, Random walks with drift.\nFor more details, refer to the related paper: Generalized Additive Forecasting Mortality:\nhttps://doi.org/10.48550/arXiv.2311.18698\nhttps://rezadastranj.quarto.pub/lme-asdrs/\nhttps://doi.org/10.48550/arXiv.2311.18668"
  },
  {
    "objectID": "index.html#plot-of-k_t",
    "href": "index.html#plot-of-k_t",
    "title": "Generalized Additive Forecasting Mortality",
    "section": "Plot of \\(k_{t}\\)",
    "text": "Plot of \\(k_{t}\\)\n\nggplot(ASDRsnw, aes(year, y, color = Age)) +\n  geom_point(size = 0.7) +\n  geom_point(aes(x = year, y = k1), color = \"black\", size = 1) +\n  geom_line(aes(x = year, y = k1), color = \"black\", linewidth = 0.7) +\n  xlab(\"Year\") +\n  ylab(\"ASDR (log)\") +\n  theme_bw() +\n  guides(color = guide_legend(override.aes = list(size = 5)))\n\n\n\n\nPlot of \\(k_{t}\\): Average of log ASDRs across 4 populations and all age groups (1961-2010)"
  },
  {
    "objectID": "index.html#plot-of-k_ct",
    "href": "index.html#plot-of-k_ct",
    "title": "Generalized Additive Forecasting Mortality",
    "section": "Plot of \\(k_{ct}\\)",
    "text": "Plot of \\(k_{ct}\\)\n\nggplot(ASDRsnw, aes(year, y, color = Age)) +\n  geom_point(size = 0.3) +\n  geom_point(aes(x = year, y = kc1, color = age_groups), size = 0.6) +\n  geom_line(aes(x = year, y = kc1, color = age_groups), linewidth = 0.4) +\n  scale_color_manual(values = c(\"Group[0,40]\" = \"red\", \"Group[45,100]\" = \"blue\")) +\n  xlab(\"Year\") +\n  ylab(\"ASDR (log)\") +\n  facet_grid(~Country) +\n  theme_bw() +\n  guides(color = guide_legend(override.aes = list(size = 3))) +\n  theme(axis.text.x = element_text(angle = 90, hjust = 1)) +\n  theme(legend.position = \"bottom\")\n\n\n\n\nPlot of \\(k_{ct}\\) for each country in our study (1961 − 2010)."
  },
  {
    "objectID": "index.html#explanation",
    "href": "index.html#explanation",
    "title": "Generalized Additive Forecasting Mortality",
    "section": "Explanation",
    "text": "Explanation\n\n1. \\(s(kc1, bs = \"ts\")\\) : Smooth term for kc1 using a thin-plate regression spline\nMathematical Representation: \\(f(kc1)\\)\nRepresents a smooth term for kc1 using a thin-plate regression spline.\n\n\n2. \\(s(kc1, by = gender:age, bs = \"ts\")\\) : Smooth term for kc1 by gender:age interaction\nRepresents a smooth term for kc1 by gender-age interaction, allowing different smooth curves for kc1 based on the combinations of gender and age. The smoothness is imposed on each combination independently.\n\n\n3. \\(s(k1, Country:gender:age, bs = \"fs\", m = 1)\\) : Random factor smooth interaction for k1 with Country:gender:age interaction\nRepresents a random factor smooth interaction for k1 with Country-gender-age interaction using a factor-smooth basis (“fs”). This allows a common smoothness constraint across different levels of Country, gender, and age. This implies a random smooth effect for k1 shared across different levels of Country, gender, and age.\n\n\n4. \\(s(cohort, Country:gender:age, bs = \"fs\", m = 1)\\) : Random factor smooth interaction for cohort with Country:gender:age interactions\nRepresents a random factor smooth interaction for cohort with Country-gender-age interactions using a factor smooth basis (“fs”). This implies a random smooth effect for the cohort variable shared across different levels of Country, gender, and age.\n\n# Plot the autocorrelation function (ACF) of the model residuals\nacf_resid(m1)"
  },
  {
    "objectID": "index.html#check-for-heteroskedasticity-and-assess-normality",
    "href": "index.html#check-for-heteroskedasticity-and-assess-normality",
    "title": "Generalized Additive Forecasting Mortality",
    "section": "Check for Heteroskedasticity and Assess Normality",
    "text": "Check for Heteroskedasticity and Assess Normality\n\n# Add fitted values and residuals to the ASDRs data frame\nASDRs$fit &lt;- fitted(m1)\nASDRs$res &lt;- resid(m1)\n\n# Scatter plot to check for heteroskedasticity\nplot(ASDRs$fit, ASDRs$res,\n  main = \"GAMM for the 4 Populations\",\n  xlab = \"Fitted Values\", ylab = \"Residuals\",\n  pch = 1, frame = FALSE, cex = 0.5, col = \"black\"\n)\n\n\n\n\n\n# Quantile-quantile plot to assess normality assumption\nqqPlot(ASDRs$res,\n       ylab = deparse(substitute())\n)\n\n\n\n\n[1] 2181 4351"
  },
  {
    "objectID": "index.html#refine-the-model",
    "href": "index.html#refine-the-model",
    "title": "Generalized Additive Forecasting Mortality",
    "section": "Refine the Model",
    "text": "Refine the Model\n\n# Filter out data points with absolute residuals outside the range [-0.07, 0.07]\nASDRs2 &lt;- ASDRs[abs(ASDRs$res) &lt;= 0.07, ]\n\n# Fit a GAMM to the refined dataset ASDRs2\nsystem.time({\n  m2 &lt;- bam(y ~ age+gender_age+\n              s(kc1,bs=\"ts\")+\n              s(kc1,by=gender_age, bs=\"ts\") +\n              s(cohort,bs=\"ts\")+\n              s(Country_gender_age,bs=\"re\") + \n              s(k1,Country_gender_age,bs=\"fs\",m=1)+\n              s(cohort,Country_gender_age,bs=\"fs\",m=1),\n            data=ASDRs2,\n          select = TRUE \n          # Enable selection penalties for smoother effects, \n          # allowing REML comparison of models\n          )\n})\n\n   user  system elapsed \n 454.65   12.03  528.98"
  },
  {
    "objectID": "index.html#check-for-heteroskedasticity-and-assess-normality-refined-model",
    "href": "index.html#check-for-heteroskedasticity-and-assess-normality-refined-model",
    "title": "Generalized Additive Forecasting Mortality",
    "section": "Check for Heteroskedasticity and Assess Normality (Refined Model)",
    "text": "Check for Heteroskedasticity and Assess Normality (Refined Model)\n\n# Add fitted values and residuals to the ASDRs2 data frame\nASDRs2$fit &lt;- fitted(m2)\nASDRs2$res &lt;- resid(m2)\n\n\n# Scatter plot to check for heteroskedasticity\nplot(ASDRs2$fit, ASDRs2$res,\n  xlab = \"Fitted Values\", ylab = \"Residuals\",\n  pch = 1, frame = FALSE, cex = 0.09, col = \"black\"\n)\n\n\n\n\n\n# Quantile-quantile plot to assess normality assumption\nqqPlot(ASDRs2$res,\n  ylab = deparse(substitute())\n)\n\n\n\n\n[1]  111 1119\n\n\n\n# Print summary statistics of the GAMM\nprint(summary(m2))\n\n\nFamily: gaussian \nLink function: identity \n\nFormula:\ny ~ age + gender_age + s(kc1, bs = \"ts\") + s(kc1, by = gender_age, \n    bs = \"ts\") + s(cohort, bs = \"ts\") + s(Country_gender_age, \n    bs = \"re\") + s(k1, Country_gender_age, bs = \"fs\", m = 1) + \n    s(cohort, Country_gender_age, bs = \"fs\", m = 1)\n\nParametric coefficients:\n                      Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)          -1.543354   0.301630  -5.117 3.31e-07 ***\nage1                 -3.077195   0.397813  -7.735 1.42e-14 ***\nage5                 -4.486662   0.332882 -13.478  &lt; 2e-16 ***\nage10                -3.979338   0.377617 -10.538  &lt; 2e-16 ***\nage15                -3.486161   0.290903 -11.984  &lt; 2e-16 ***\nage20                -3.151064   0.289236 -10.894  &lt; 2e-16 ***\nage25                -3.029308   0.324161  -9.345  &lt; 2e-16 ***\nage30                -2.989491   0.286581 -10.432  &lt; 2e-16 ***\nage35                -2.720658   0.285910  -9.516  &lt; 2e-16 ***\nage40                -2.729674   0.357736  -7.630 3.16e-14 ***\nage45                -5.694335   0.344039 -16.551  &lt; 2e-16 ***\nage50                -4.537635   0.343731 -13.201  &lt; 2e-16 ***\nage55                -4.030300   0.343651 -11.728  &lt; 2e-16 ***\nage60                -3.566703   0.343871 -10.372  &lt; 2e-16 ***\nage65                -3.877051   0.344372 -11.258  &lt; 2e-16 ***\nage70                -2.808841   0.345099  -8.139 5.86e-16 ***\nage75                -2.780184   0.346130  -8.032 1.38e-15 ***\nage80                -1.849454   0.347396  -5.324 1.09e-07 ***\nage85                -1.578434   0.348834  -4.525 6.29e-06 ***\nage90                -0.917206   0.358083  -2.561 0.010475 *  \nage95                -0.626256   0.355871  -1.760 0.078551 .  \nage100                1.159337   3.165969   0.366 0.714252    \ngender_ageMale.0      1.375182   2.474404   0.556 0.578416    \ngender_ageFemale.1    0.000000   0.000000     NaN      NaN    \ngender_ageMale.1      0.339560   0.418167   0.812 0.416848    \ngender_ageFemale.5    0.000000   0.000000     NaN      NaN    \ngender_ageMale.5      1.143994   0.398782   2.869 0.004151 ** \ngender_ageFemale.10  -0.678034   0.351784  -1.927 0.054026 .  \ngender_ageMale.10     0.000000   0.000000     NaN      NaN    \ngender_ageFemale.15  -1.089046   0.215503  -5.054 4.61e-07 ***\ngender_ageMale.15     0.000000   0.000000     NaN      NaN    \ngender_ageFemale.20  -1.136416   0.094528 -12.022  &lt; 2e-16 ***\ngender_ageMale.20     0.000000   0.000000     NaN      NaN    \ngender_ageFemale.25  -0.987734   0.221423  -4.461 8.48e-06 ***\ngender_ageMale.25     0.000000   0.000000     NaN      NaN    \ngender_ageFemale.30  -0.904790   0.200943  -4.503 6.98e-06 ***\ngender_ageMale.30     0.000000   0.000000     NaN      NaN    \ngender_ageFemale.35  -0.604116   0.062529  -9.661  &lt; 2e-16 ***\ngender_ageMale.35     0.000000   0.000000     NaN      NaN    \ngender_ageFemale.40  -0.779184   0.336873  -2.313 0.020794 *  \ngender_ageMale.40     0.000000   0.000000     NaN      NaN    \ngender_ageFemale.45   0.000000   0.000000     NaN      NaN    \ngender_ageMale.45     0.619801   0.048487  12.783  &lt; 2e-16 ***\ngender_ageFemale.50  -0.571564   0.154525  -3.699 0.000221 ***\ngender_ageMale.50     0.000000   0.000000     NaN      NaN    \ngender_ageFemale.55  -0.809849   0.048847 -16.579  &lt; 2e-16 ***\ngender_ageMale.55     0.000000   0.000000     NaN      NaN    \ngender_ageFemale.60  -0.778948   0.053805 -14.477  &lt; 2e-16 ***\ngender_ageMale.60     0.000000   0.000000     NaN      NaN    \ngender_ageFemale.65   0.000000   0.000000     NaN      NaN    \ngender_ageMale.65     0.692174   0.079251   8.734  &lt; 2e-16 ***\ngender_ageFemale.70  -0.574908   0.070085  -8.203 3.50e-16 ***\ngender_ageMale.70     0.000000   0.000000     NaN      NaN    \ngender_ageFemale.75   0.000000   0.000000     NaN      NaN    \ngender_ageMale.75     0.376813   0.137231   2.746 0.006073 ** \ngender_ageFemale.80  -0.326683   0.091539  -3.569 0.000365 ***\ngender_ageMale.80     0.000000   0.000000     NaN      NaN    \ngender_ageFemale.85   0.000000   0.000000     NaN      NaN    \ngender_ageMale.85     0.160520   0.155277   1.034 0.301333    \ngender_ageFemale.90  -0.103188   0.175105  -0.589 0.555714    \ngender_ageMale.90     0.000000   0.000000     NaN      NaN    \ngender_ageFemale.95   0.000000   0.000000     NaN      NaN    \ngender_ageMale.95    -0.003264   0.202707  -0.016 0.987154    \ngender_ageFemale.100  0.000000   0.000000     NaN      NaN    \ngender_ageMale.100    3.207742   5.844574   0.549 0.583157    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nApproximate significance of smooth terms:\n                                   edf Ref.df       F  p-value    \ns(kc1)                       4.193e+00      9 115.234  &lt; 2e-16 ***\ns(kc1):gender_ageFemale.0    9.478e-01      9   0.944 2.78e-06 ***\ns(kc1):gender_ageMale.0      3.948e+00      9   3.910  &lt; 2e-16 ***\ns(kc1):gender_ageFemale.1    9.752e-01      9   0.989 1.10e-06 ***\ns(kc1):gender_ageMale.1      9.632e-01      9   1.076 7.78e-07 ***\ns(kc1):gender_ageFemale.5    4.075e-01      9   0.074  0.04469 *  \ns(kc1):gender_ageMale.5      1.007e+00      9   1.626  &lt; 2e-16 ***\ns(kc1):gender_ageFemale.10   6.421e-01      9   0.187  0.00607 ** \ns(kc1):gender_ageMale.10     8.612e-01      9   0.555 5.42e-05 ***\ns(kc1):gender_ageFemale.15   5.015e-01      9   0.106  0.02074 *  \ns(kc1):gender_ageMale.15     1.825e-05      9   0.000  0.42429    \ns(kc1):gender_ageFemale.20   1.870e-05      9   0.000  0.79114    \ns(kc1):gender_ageMale.20     2.034e-05      9   0.000  0.38221    \ns(kc1):gender_ageFemale.25   2.747e-01      9   0.042  0.07285 .  \ns(kc1):gender_ageMale.25     4.377e-01      9   0.085  0.04332 *  \ns(kc1):gender_ageFemale.30   5.285e-01      9   0.121  0.02490 *  \ns(kc1):gender_ageMale.30     2.962e-04      9   0.000  0.12172    \ns(kc1):gender_ageFemale.35   3.613e-04      9   0.000  0.13391    \ns(kc1):gender_ageMale.35     5.249e-05      9   0.000  0.19760    \ns(kc1):gender_ageFemale.40   9.071e-01      9   0.730 6.00e-05 ***\ns(kc1):gender_ageMale.40     8.017e-01      9   0.378  0.00213 ** \ns(kc1):gender_ageFemale.45   1.397e-05      7   0.000  0.78753    \ns(kc1):gender_ageMale.45     2.154e-05      7   0.000  0.53495    \ns(kc1):gender_ageFemale.50   5.196e-01      7   0.153  0.05172 .  \ns(kc1):gender_ageMale.50     1.884e-05      7   0.000  0.84382    \ns(kc1):gender_ageFemale.55   1.435e-05      7   0.000  0.69966    \ns(kc1):gender_ageMale.55     4.078e-05      7   0.000  0.25546    \ns(kc1):gender_ageFemale.60   7.951e-05      7   0.000  0.21250    \ns(kc1):gender_ageMale.60     1.916e-05      7   0.000  0.77660    \ns(kc1):gender_ageFemale.65   1.795e-05      7   0.000  0.80744    \ns(kc1):gender_ageMale.65     6.785e-02      7   0.010  0.16405    \ns(kc1):gender_ageFemale.70   4.662e-04      7   0.000  0.18855    \ns(kc1):gender_ageMale.70     2.226e-05      7   0.000  0.56798    \ns(kc1):gender_ageFemale.75   1.821e-05      7   0.000  0.83326    \ns(kc1):gender_ageMale.75     3.398e-01      7   0.073  0.10163    \ns(kc1):gender_ageFemale.80   1.839e-05      7   0.000  0.91198    \ns(kc1):gender_ageMale.80     1.843e-05      7   0.000  0.92500    \ns(kc1):gender_ageFemale.85   3.395e-05      7   0.000  0.31362    \ns(kc1):gender_ageMale.85     3.657e-01      7   0.082  0.09613 .  \ns(kc1):gender_ageFemale.90   3.140e-01      7   0.065  0.10780    \ns(kc1):gender_ageMale.90     1.568e-01      7   0.027  0.14577    \ns(kc1):gender_ageFemale.95   5.884e-02      7   0.009  0.15918    \ns(kc1):gender_ageMale.95     5.211e-01      7   0.154  0.05173 .  \ns(kc1):gender_ageFemale.100  2.707e+00      9   3.438  &lt; 2e-16 ***\ns(kc1):gender_ageMale.100    2.882e+00      9   5.952  &lt; 2e-16 ***\ns(cohort)                    7.357e+00      9   5.733  &lt; 2e-16 ***\ns(Country_gender_age)        2.141e+00     44   0.053  &lt; 2e-16 ***\ns(k1,Country_gender_age)     3.350e+02    748   1.087  &lt; 2e-16 ***\ns(cohort,Country_gender_age) 2.839e+02    747   3.154  &lt; 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nRank: 2130/2151\nR-sq.(adj) =      1   Deviance explained =  100%\nfREML = -6203.1  Scale est. = 0.00090126  n = 3566\n\n\n\n# Create and display four plots based on the GAMM 'm2'\nplot(m2, ylim = c(-0.6, 0.9), select = 24)\n\n\n\nplot(m2, ylim = c(-0.6, 0.2), select = 46)\n\n\n\nplot(m2, ylim = c(-0.094, 0.08), select = 48)\n\n\n\nplot(m2, ylim = c(-0.64, 0.45), select = 49)\n\n\n\n\n\n# Plot the autocorrelation function (ACF) of the model residuals\nacf_resid(m2)"
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "Mixed Effects Modelling Mortality"
  }
]